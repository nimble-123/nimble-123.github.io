
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hello World! - Just My Two Cents</title>
  <meta name="author" content="Nils Lutz">

  
  <meta name="description" content="Da ist er nun, mein erster Beitrag in meinem eigenen Blog. Gute 2 Jahre hat es gedauert bis ich mich dazu durch gerungen habe ihn tatsächlich zu &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://nlsltz.github.io/2014/02/07/hello-world/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Just My Two Cents" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=Arvo:400,400italic,700,700italic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Playball" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-52478234-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Just My Two Cents</a></h1>
  
    <h2>Linux, Raspberry Pi, Android</h2>
  
</hgroup>

</header>
  <div id="navigation">
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:nlsltz.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  </div>
  <div id="body"  >
    <div id="main">
      <div id="content">
        <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Hello World!</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-07T16:29:41+01:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="right" src="/images/2014-02-07-16-15-32.jpg" width="350" height="350" title="Mein Raspberry Pi" alt="Mein Raspberry Pi">Da ist er nun, mein erster Beitrag in meinem eigenen Blog. Gute 2 Jahre hat es gedauert bis ich mich dazu durch gerungen habe ihn tatsächlich zu erstellen. Wie der Blog Titel schon verrät will ich hier immer mal wieder meine Errungenschaften mit Linux, dem Raspberry Pi, Android sowie sonstigem Kram nieder schreiben. Den Anfang machen möchte ich mit einer kleinen Step-to-Step Anleitung wie ich meinen Raspberry Pi als PHP Webserver eingerichtet habe.<!-- more --></p>

<p>Kurz für alle die nicht wissen was ein Raspberry Pi ist. Das ist ein kleiner Einplatinen-Computer, angetrieben von einer 700 MHz ARM CPU mit 512 MB RAM, einem Grafikchip der die Videoausgabe auch in 1080p Full HD schafft. Als Speicher kommt eine SD Karte zum Einsatz, zusätzlich lassen sich über die beiden USB 2.0 Ports noch weitere Medien anschließen. An meinem Pi hängt noch ein USB Hub mit externer Stromzufuhr um nicht auf die beiden vorhandenen Ports limitiert zu sein.</p>

<p>Soviel zum Pi selbst kommen wir nun zur Einrichtung des Webservers. Ich habe mich nach ein wenig Recherche auf Google dazu entschlossen <a href="http://wiki.nginx.org/Main">Nginx</a> einzusetzen, da der Apache wohl zu <a href="http://www.jeremymorgan.com/blog/programming/raspberry-pi-web-server-comparison/">Ressourcen hungrig</a> ist. Als erstes mal über SSH auf den Pi verbinden. In meinem Fall ist der User <code>root</code> und mein Pi im Netzwerk als <code>raspberrypi</code> bekannt.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ssh root@raspberrypi
</span></code></pre></td></tr></table></div></figure>


<p>Auf dem Pi selbst aktualisieren wir die Paketlisten und installieren dann mit <code>apt</code> den Webserver Nginx und PHP mit ein paar Erweiterungen.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get install nginx php5 php5-fpm php-apc php5-mcrypt php5-cli php5-gd
</span></code></pre></td></tr></table></div></figure>


<p>Nachdem Nginx inkl. seiner Abhängigkeiten installiert wurde optimieren wir als erstes die sog. Worker Prozesse &amp; Connections um sie an den Pi anzupassen. Dies geht mittels <code>sed</code> oder Manuell in der Datei <code>/etc/nginx/nginx.conf</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo sed -i <span class="s2">&quot;s/worker_processes 4;/worker_processes 1;/g&quot;</span> /etc/nginx/nginx.conf
</span><span class='line'>sudo sed -i <span class="s2">&quot;s/worker_connections 768;/worker_connections 128;/g&quot;</span> /etc/nginx/nginx.conf
</span></code></pre></td></tr></table></div></figure>


<p>
Nun noch den Webserver starten mittels folgendem Befehl und dann im Browser über die IP Adresse des Pi schauen ob ein <em>Welcome to nginx</em> einem bestätigt das alles läuft.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo service nginx restart
</span></code></pre></td></tr></table></div></figure>


<p>Der Webserver verrichtet seinen Dienst, allerdings ist er noch absolut jungfräulich was seine Einstellungen betrifft. Das ändern wir jetzt. Um zu verstehen wieso wir das tun was wir jetzt tun muss man wissen wie Nginx arbeitet. Beim Start des Dienstes überprüft Nginx den Ordner <code>/etc/nginx/sites-enabled/</code> nach Konfigurationsdateien für die <a href="http://de.wikipedia.org/wiki/Virtual_Hosting">vHosts</a>. Üblicherweise werden in diesem Ordner aber keine Dateien selbst liegen sondern nur Symlinks die auf die Konfigdateien im Ordner <code>/etc/nginx/sites-availabe/</code> verweisen. Will man beispielsweise eine Seite nicht mehr weiter verteilen reicht es völlig aus dessen Symlink zu entfernen. Weiter ist die Standard Konfiguration nicht grade optimal, in Bezug auf den Speicherort der ausgelieferten Seite. Im großen Linux Universum hat sich das Verzeichnis <code>/var/www/</code> als de Facto Standard entpuppt, Nginx zeigt jedoch im auslieferungszustand auf <code>/usr/share/nginx/www/</code>. Diese Unstimmigkeiten ändern wir nun. Außerdem konfigurieren wir den PHP Support damit Nginx auch dynamische Webseiten, die mit PHP erstellt wurden, ausliefern kann.</p>

<p>Stoppen wir zuerst den Webserver und entfernen den Symlink des Standard vHost.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo service nginx stop
</span><span class='line'>sudo unlink /etc/nginx/sites-enabled/default
</span></code></pre></td></tr></table></div></figure>


<p>
Jetzt legen wir einen neuen vHost in <code>/etc/nginx/sites-availabe/mysite</code> mit folgendem Inhalt an. Dadurch lauscht Nginx auf Port 80 und verteilt im Falle einer Anfrage die Dateien aus dem Verzeichnis <code>/var/www/</code>. Der <code>location</code> Block ist für den PHP Support zuständig. Er sagt Nginx das jegliche Anfragen die auf <code>.php</code> enden an den PHP Interpreter weiter gereicht werden. </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo touch /etc/nginx/sites-availabe/mysite
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span>Nginx Site Config File</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>server <span class="o">{</span>
</span><span class='line'>        listen 80<span class="p">;</span>
</span><span class='line'>        root /var/www<span class="p">;</span>
</span><span class='line'>        index index.php index.html index.htm<span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        location ~ <span class="o">[</span>^/<span class="o">]</span>.php<span class="o">(</span>/<span class="p">|</span><span class="nv">$)</span> <span class="o">{</span>
</span><span class='line'>                try_files <span class="nv">$uri</span> <span class="o">=</span>404<span class="p">;</span>
</span><span class='line'>                fastcgi_split_path_info ^<span class="o">(</span>.+?.php<span class="o">)(</span>/.*<span class="o">)</span><span class="nv">$;</span>
</span><span class='line'>                fastcgi_pass unix:/var/run/php5-fpm.sock<span class="p">;</span>
</span><span class='line'>                fastcgi_index index.php<span class="p">;</span>
</span><span class='line'>                include fastcgi_params<span class="p">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
So nun <a href="http://wiki.ubuntuusers.de/ln#Symbolische-Verknuepfungen">symlinken</a> wir noch den erstellten vHost in den Ordner <code>/etc/nginx/sites-enabled/</code>, deaktivieren in der <code>php.ini</code> den <code>CGI.PATH_INFO</code> fix und starten Nginx und PHP5-FPM.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo ln -s /etc/nginx/sites-available/mysite /etc/nginx/sites-enabled/mysite
</span><span class='line'>sudo sed -i <span class="s2">&quot;s/^;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/&quot;</span> /etc/php5/fpm/php.ini
</span><span class='line'>sudo service php5-fpm restart
</span><span class='line'>sudo service nginx restart
</span></code></pre></td></tr></table></div></figure>


<p>
Jetzt kann jede Webseite Seite, die im Ordner <code>/var/www/</code> liegt, von Nginx verteilt werden.</p>

<p>Er ist doch um einiges länger geworden als ich zu erst gedacht hatte, aber gut :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Nils Lutz</span></span>

      








  


<time datetime="2014-02-07T16:29:41+01:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/raspberrypi/'>raspberrypi</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://nlsltz.github.io/2014/02/07/hello-world/" data-via="" data-counturl="http://nlsltz.github.io/2014/02/07/hello-world/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/2014/02/09/default-user-und-swap-grosse-des-raspberry-pi-andern/" title="Next Post: Default User und Swap Grösse des Raspberry Pi ändern">Default User und Swap Grösse des Raspberry Pi ändern &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/10/21/openvpn-auf-dem-raspberry-pi-einrichten/">OpenVPN auf dem RaspberryPi einrichten</a>
      </li>
    
      <li class="post">
        <a href="/2014/09/04/umstieg-von-wordpress-auf-octopress/">Umstieg von Wordpress auf Octopress</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/16/plex-media-server-einrichten/">Plex Media Server einrichten</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/09/default-user-und-swap-grosse-des-raspberry-pi-andern/">Default User und Swap Grösse des Raspberry Pi ändern</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/07/hello-world/">Hello World!</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/nlsltz">@nlsltz</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'nlsltz',
            count: 0,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


      </div>
    </div>
    <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Nils Lutz -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a></span>
</p>

</footer>
    



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </div>
</body>
</html>
